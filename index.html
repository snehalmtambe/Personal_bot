<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Clone | Universal AI Interface</title>
    <style>
        /* --- 1. CORE VARIABLES & RESET --- */
        :root {
            --bg-body: #131314;
            --bg-sidebar: #1e1f20;
            --bg-input: #1e1f20;
            --bg-user-bubble: #282a2c;
            --bg-ai-bubble: transparent;
            --text-primary: #e3e3e3;
            --text-secondary: #a8a8a8;
            --accent-blue: #4c8df6;
            --accent-gradient: linear-gradient(90deg, #4b90ff, #ff5546);
            --font-main: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            --transition-speed: 0.2s;
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; outline: none; }
        body {
            margin: 0;
            background-color: var(--bg-body);
            color: var(--text-primary);
            font-family: var(--font-main);
            height: 100vh;
            display: flex;
            overflow: hidden;
            font-size: 16px;
            line-height: 1.6;
        }

        /* --- 2. LAYOUT --- */
        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--bg-sidebar);
            display: flex;
            flex-direction: column;
            padding: 1rem;
            transition: transform var(--transition-speed) ease;
            z-index: 10;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                height: 100%;
                transform: translateX(-100%);
            }
            .sidebar.open { transform: translateX(0); }
        }

        .new-chat-btn {
            background-color: #282a2c;
            color: var(--text-secondary);
            border: none;
            padding: 12px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            transition: all 0.2s;
            margin-bottom: 20px;
        }
        .new-chat-btn:hover { background-color: #37393b; color: var(--text-primary); }

        .history-list {
            flex: 1;
            overflow-y: auto;
            margin-top: 10px;
        }
        .history-item {
            padding: 10px 14px;
            border-radius: 18px;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .history-item:hover { background-color: #2c2e30; color: var(--text-primary); }

        /* Main Chat Area */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            max-width: 100%;
        }

        .top-bar {
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-secondary);
        }
        .menu-toggle {
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
        }
        .menu-toggle:hover { background-color: #2c2e30; }

        /* Chat Scroll Area */
        #chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 2rem 1rem;
            display: flex;
            flex-direction: column;
            gap: 2rem;
            scroll-behavior: smooth;
        }

        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            opacity: 1;
            transition: opacity 0.3s;
        }
        .welcome-screen.hidden { display: none; }
        
        .welcome-text {
            font-size: 3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -1px;
        }
        .welcome-sub { font-size: 1.5rem; color: #5f6368; }

        /* Message Bubbles */
        .message-row {
            display: flex;
            justify-content: center;
            width: 100%;
            animation: fadeIn 0.3s ease-out;
        }
        
        .message-content {
            width: 100%;
            max-width: 800px;
            display: flex;
            gap: 1.2rem;
            padding: 0 1rem;
        }

        .avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .user-avatar { background: #3c4043; }
        .ai-avatar { 
            background: transparent; /* Use SVG */
        }

        .text-payload {
            flex: 1;
            padding-top: 2px;
        }
        
        /* Markdown Styling Simulation */
        .text-payload h1, .text-payload h2 { margin-top: 0; color: #fff; }
        .text-payload p { margin-bottom: 0.8rem; margin-top: 0; }
        .text-payload code { 
            background: #2d2f31; 
            padding: 2px 6px; 
            border-radius: 4px; 
            font-family: monospace; 
            font-size: 0.9em;
        }
        .text-payload pre {
            background: #2d2f31;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
        }
        .text-payload ul { padding-left: 20px; }

        /* Input Area */
        .input-area-wrapper {
            padding: 1rem 1rem 2rem 1rem;
            display: flex;
            justify-content: center;
            background: linear-gradient(180deg, rgba(19,19,20,0) 0%, var(--bg-body) 40%);
        }

        .input-container {
            width: 100%;
            max-width: 800px;
            background-color: var(--bg-input);
            border-radius: 30px;
            padding: 10px 16px;
            display: flex;
            align-items: flex-end;
            gap: 12px;
            border: 1px solid transparent;
            transition: border 0.2s;
        }
        .input-container:focus-within { border-color: #444746; }

        .action-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .action-btn:hover { background: #333; color: var(--text-primary); }

        textarea {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
            resize: none;
            max-height: 200px;
            padding: 12px 0;
            height: 48px; /* Initial height */
        }
        textarea::placeholder { color: #8e8e8e; }

        .send-btn {
            background: var(--text-primary);
            color: var(--bg-body);
        }
        .send-btn:hover { background: #fff; }
        .send-btn:disabled { opacity: 0.5; cursor: default; }

        /* Loading Indicator */
        .typing-indicator {
            display: inline-flex;
            gap: 4px;
        }
        .typing-dot {
            width: 6px;
            height: 6px;
            background: #fff;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        @keyframes rotate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* SVG Icons Helpers */
        .icon { width: 24px; height: 24px; fill: currentColor; }
        .gemini-sparkle {
            background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2Z" fill="url(%23grad1)"/></svg>');
        }
    </style>
</head>
<body>

    <aside class="sidebar" id="sidebar">
        <div class="menu-toggle" onclick="toggleSidebar()" style="align-self: flex-start; margin-bottom: 20px; display: none;">
            <svg class="icon" viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
        </div>
        
        <button class="new-chat-btn" onclick="resetChat()">
            <svg class="icon" viewBox="0 0 24 24" style="width:18px;height:18px"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
            New chat
        </button>

        <div style="font-size: 0.8rem; font-weight: 600; margin: 10px 10px 5px; color: #fff;">Recent</div>
        <div class="history-list" id="history-list">
            <div class="history-item"><svg class="icon" style="width:16px; margin-right:5px" viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg> React vs Vue Analysis</div>
            <div class="history-item"><svg class="icon" style="width:16px; margin-right:5px" viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg> System Architecture</div>
        </div>
        
        <div style="margin-top: auto; padding-top: 10px; border-top: 1px solid #333;">
            <div class="history-item">
                <svg class="icon" style="width:18px;" viewBox="0 0 24 24"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.5.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/></svg>
                Settings
            </div>
        </div>
    </aside>

    <main class="main-content">
        <div class="top-bar">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div class="menu-toggle" onclick="toggleSidebar()">
                    <svg class="icon" viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
                </div>
                <span style="font-weight: 500; font-size: 1.1rem; color: #e3e3e3;">Gemini Pro</span>
            </div>
            <div class="avatar user-avatar" style="background: linear-gradient(135deg, #FF6B6B, #4ECDC4); width: 36px; height: 36px;">
                <span style="font-size: 14px; font-weight: bold; color: #fff;">U</span>
            </div>
        </div>

        <div id="chat-container">
            <div class="welcome-screen" id="welcome-screen">
                <div class="welcome-text">Hello, Developer</div>
                <div class="welcome-sub">How can I help you build today?</div>
            </div>
        </div>

        <div class="input-area-wrapper">
            <div class="input-container">
                <button class="action-btn">
                    <svg class="icon" viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                </button>
                <textarea id="user-input" rows="1" placeholder="Enter a prompt here" oninput="autoResize(this)"></textarea>
                <button class="action-btn">
                   <svg class="icon" viewBox="0 0 24 24"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 2.34 9 5v6c0 1.66 1.34 3 3 3z"/><path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/></svg>
                </button>
                <button class="action-btn send-btn" id="send-btn" onclick="handleSend()">
                    <svg class="icon" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                </button>
            </div>
        </div>
    </main>

    <script>
        /* --- 3. LOGIC & INTERACTION --- */
        
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const welcomeScreen = document.getElementById('welcome-screen');
        const sidebar = document.getElementById('sidebar');
        let isGenerating = false;

        // Auto-resize textarea
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 200) + 'px';
            if(textarea.value === '') textarea.style.height = '48px';
        }

        // Toggle Sidebar
        function toggleSidebar() {
            sidebar.classList.toggle('open');
            // Simplified for desktop: toggle width logic could be added here
        }

        // Reset Chat
        function resetChat() {
            chatContainer.innerHTML = '';
            chatContainer.appendChild(welcomeScreen);
            welcomeScreen.classList.remove('hidden');
            userInput.value = '';
            autoResize(userInput);
        }

        // Handle Enter Key
        userInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                handleSend();
            }
        });

        // 1. Create Message UI
        function createMessageBubble(text, isUser = true) {
            const row = document.createElement('div');
            row.className = 'message-row';
            
            // Avatar SVG Strings
            const userAvatarSvg = `<span style="color:white; font-weight:bold;">U</span>`;
            
            // Google Gemini-style Star SVG
            const aiAvatarSvg = `
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width:24px; height:24px;">
                <defs><linearGradient id="g1" x1="0" y1="0" x2="24" y2="24"><stop offset="0%" stop-color="#4b90ff"/><stop offset="100%" stop-color="#ff5546"/></linearGradient></defs>
                <path d="M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2Z" fill="url(#g1)"/>
                </svg>`;

            row.innerHTML = `
                <div class="message-content">
                    <div class="avatar ${isUser ? 'user-avatar' : 'ai-avatar'}">
                        ${isUser ? userAvatarSvg : aiAvatarSvg}
                    </div>
                    <div class="text-payload">${isUser ? escapeHtml(text) : ''}</div>
                </div>
            `;
            return row;
        }

        // 2. Handle Send Logic
        async function handleSend() {
            const text = userInput.value.trim();
            if (!text || isGenerating) return;

            // UI Updates
            welcomeScreen.classList.add('hidden');
            userInput.value = '';
            userInput.style.height = '48px';
            isGenerating = true;

            // Add User Message
            const userMsg = createMessageBubble(text, true);
            chatContainer.appendChild(userMsg);
            scrollToBottom();

            // Add AI Placeholder (Thinking State)
            const aiMsg = createMessageBubble('', false);
            const payloadDiv = aiMsg.querySelector('.text-payload');
            payloadDiv.innerHTML = `<div class="typing-indicator"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div>`;
            chatContainer.appendChild(aiMsg);
            scrollToBottom();

            // Simulate Network Delay & Stream
            setTimeout(() => {
                payloadDiv.innerHTML = ''; // Remove typing indicator
                streamResponse(payloadDiv, generateMockResponse(text));
            }, 800 + Math.random() * 500);
        }

        // 3. Simulated Response Engine
        function generateMockResponse(prompt) {
            // Simple keyword matching for demo purposes
            const p = prompt.toLowerCase();
            if (p.includes('code') || p.includes('function') || p.includes('javascript')) {
                return `Here is a **JavaScript** example demonstrating an asynchronous fetch request with error handling:

\`\`\`javascript
async function fetchData(url) {
  try {
    const response = await fetch(url);
    if (!response.ok) {
       throw new Error('Network response was not ok');
    }
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('Fetch error:', error);
  }
}
\`\`\`

This function handles the *async/await* pattern and ensures that failed HTTP requests are caught in the catch block.`;
            }
            
            if (p.includes('list') || p.includes('plan')) {
                return `Here is a breakdown of the plan:

1. **Analysis**: Gather requirements.
2. **Design**: Create high-fidelity mockups.
3. **Development**:
    * Frontend implementation
    * Backend API integration
4. **Testing**: Unit and E2E tests.

Let me know if you want to expand on the *Design* phase.`;
            }

            return `I am a **simulated AI** running entirely in your browser using vanilla JavaScript. 

You said: "${prompt}". 

I can simulate Markdown parsing, code blocks, and dynamic text streaming without a backend. Try asking me for some code!`;
        }

        // 4. Streamer & Formatter
        function streamResponse(element, fullText) {
            let index = 0;
            const speed = 20; // ms per char

            const interval = setInterval(() => {
                if (index < fullText.length) {
                    // In a real app, we would parse MD incrementally. 
                    // Here, we append raw text then parse the whole thing periodically 
                    // or just once at the end for simplicity in this zero-dependency demo.
                    
                    // For better visuals, we just slice the text and parse it.
                    const currentText = fullText.slice(0, index + 1);
                    element.innerHTML = parseMarkdown(currentText);
                    
                    index++;
                    scrollToBottom();
                } else {
                    clearInterval(interval);
                    isGenerating = false;
                }
            }, speed);
        }

        // 5. Basic Zero-Dependency Markdown Parser
        function parseMarkdown(text) {
            let html = text
                // Escape HTML (basic)
                .replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;")
                // Code Blocks (```)
                .replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>')
                // Inline Code (`)
                .replace(/`([^`]+)`/g, '<code>$1</code>')
                // Bold (**)
                .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
                // Italic (*)
                .replace(/\*([^*]+)\*/g, '<em>$1</em>')
                // Lists - currently simplified to breaks for streaming stability
                .replace(/\n\d\./g, '<br>•') 
                .replace(/\n\*/g, '<br>•')
                // Newlines
                .replace(/\n/g, '<br>');
            
            return html;
        }

        function escapeHtml(text) {
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        function scrollToBottom() {
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
    </script>
</body>
</html>
